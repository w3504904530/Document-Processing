# GUI使用说明

## 概述

文件对比工具提供了图形用户界面(GUI)，让您可以方便地进行文件对比操作，包括新增加的行顺序保留功能。

## 界面说明

### 1. 文件选择区域
- **文件1**: 选择第一个要对比的文件（支持CSV、Excel格式）
- **文件2**: 选择第二个要对比的文件（支持CSV、Excel格式）
- **输出文件**: 设置对比结果的保存路径

### 2. 对比参数区域
- **比较列名**: 指定用于匹配两个文件的列名（如：A、B、ID等）
- **行顺序策略**: 选择行顺序保留策略
  - `None`: 按比较列的值排序（默认）
  - `df1`: 保留文件1的原始行顺序
  - `df2`: 保留文件2的原始行顺序
- **列排序策略**: 选择输出文件中列的排列方式
  - `alternating`: 交替排列（推荐）
  - `grouped`: 分组排列
  - `alphabetical`: 按字母顺序排列

### 3. 操作按钮
- **开始对比**: 执行文件对比操作
- **清空日志**: 清除日志区域的内容
- **打开输出文件夹**: 在文件管理器中打开输出文件所在文件夹

### 4. 处理日志
显示处理过程中的详细信息，包括：
- 文件读取状态
- 列名信息
- 使用的策略
- 处理结果
- 索引列添加信息

## 行顺序保留功能

### 功能说明
新增的行顺序保留功能允许您选择保留哪个文件的原始行顺序，避免因比较列的值排序而改变行的原始排列顺序。

### 使用方法
1. 在"行顺序策略"下拉菜单中选择：
   - `None`: 按比较列的值排序，同时添加两个索引列
   - `df1`: 保留文件1的原始行顺序，添加文件1的索引列
   - `df2`: 保留文件2的原始行顺序，添加文件2的索引列

2. 系统会自动添加相应的索引列：
   - `_df1_original_index`: 文件1的原始行索引
   - `_df2_original_index`: 文件2的原始行索引

### 索引列的作用
- 帮助您在Excel中手动按原始顺序排序
- 追踪每行数据在原始文件中的位置
- 在需要时恢复到原始文件的行顺序

## 使用步骤

### 1. 准备文件
确保您有两个要对比的文件，它们至少有一个共同的列名用于匹配。

### 2. 选择文件
- 点击"浏览"按钮选择文件1和文件2
- 设置输出文件路径

### 3. 设置参数
- 输入比较列名（必须存在于两个文件中）
- 选择行顺序策略
- 选择列排序策略

### 4. 执行对比
- 点击"开始对比"按钮
- 等待处理完成
- 查看日志信息确认处理结果

### 5. 查看结果
- 点击"打开输出文件夹"查看生成的文件
- 在Excel中打开结果文件查看对比效果
- 使用索引列进行手动排序（如需要）

## 注意事项

1. **文件格式**: 支持CSV和Excel文件格式
2. **编码问题**: CSV文件建议使用UTF-8编码
3. **列名匹配**: 比较列名必须完全一致（区分大小写）
4. **文件大小**: 大文件处理可能需要较长时间
5. **输出目录**: 确保输出目录有写入权限

## 常见问题

### Q: 为什么没有找到可高亮的成对列？
A: 这通常是因为两个文件没有相同的列名（除了比较列）。这是正常现象，不影响对比结果。

### Q: 索引列有什么用？
A: 索引列记录了每行数据在原始文件中的位置，您可以在Excel中按索引列排序来恢复原始文件的行顺序。

### Q: 如何选择合适的行顺序策略？
A: 
- 如果您希望保持文件1的逻辑顺序，选择 `df1`
- 如果您希望保持文件2的逻辑顺序，选择 `df2`
- 如果您希望按比较列的值排序，选择 `None`

### Q: 处理过程中界面卡住了怎么办？
A: 这是正常现象，处理过程在后台线程中执行，请耐心等待。处理完成后界面会自动恢复响应。

## 示例

假设您有两个文件：
- `员工信息1.xlsx`: 包含员工ID、姓名、部门信息
- `员工信息2.csv`: 包含员工ID、工资、职位信息

使用步骤：
1. 选择两个文件
2. 比较列名设置为"员工ID"
3. 行顺序策略选择"df1"（保持员工信息1的顺序）
4. 列排序策略选择"alternating"
5. 执行对比

结果文件将按照员工信息1的顺序排列，并包含 `_df1_original_index` 列，方便您追踪原始顺序。
